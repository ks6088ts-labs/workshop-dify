<!-- Prompt: #file:index.md には疑問点ややることの骨子が書かれています。それぞれの作業内容について、技術的知識がない初心者でもわかるように丁寧な説明を追記してください。可能な限り有用な情報ソースを付け加えてください。 -->

# Dify 入門

## Dify のキャッチアップ

### Q. どういうソリューションなのか？誰向けのなんのツールなのか？想定するユーザーは誰でどういう課題を達成できるツールなのか？機能として何があって何がないのか？

Dify は、AI アプリケーションの開発と運用を簡単にするためのオープンソースプラットフォームです。プログラミング知識がなくても、大規模言語モデル（LLM）を活用したアプリケーションを構築できることが特徴です。

**ターゲットユーザー**:

- プログラミングスキルがない非技術者やビジネスユーザー
- AI アプリ開発を効率化したい開発者
- LLM を活用したソリューションを素早くプロトタイピングしたいプロダクトマネージャー

**解決できる課題**:

- プログラミングなしで AI アプリケーションを作成できる
- 複雑な AI ワークフローをビジュアルに構築できる
- 独自のデータを使用した RAG（Retrieval Augmented Generation）システムの構築
- 既存のシステムとの API ベースの統合

**主な機能**:

- ノーコードで AI アプリケーション開発
- チャットボット・テキスト生成アプリの構築
- ビジュアルなワークフローエディタ
- RAG（Retrieval Augmented Generation）機能
- API 統合機能
- データセット管理
- 複数の LLM（OpenAI、Claude、Llama 等）へのインターフェース
- カスタムコード実行機能

**現時点での制限**:

- 一部の高度なカスタマイズにはコーディングが必要
- 大規模なエンタープライズ統合には追加設定が必要になる場合がある
- 処理速度はバックエンドの LLM に依存

### Q. クイックに動かせる環境を構築するには何をしたらいいのか？環境構築方法として何があるのか?

Dify を始めるための環境構築には、主に 3 つの方法があります。初心者には Docker Compose がおすすめです。

**1. Docker Compose を使う方法（推奨・簡単）**:

必要なもの:

- Docker と docker-compose がインストールされていること
- 最低 8GB の RAM
- Git

手順:

```bash
# リポジトリをクローン
git clone https://github.com/langgenius/dify.git
cd dify

# .envファイルをコピー
cp .env.example .env

# .envファイルを編集し、必要なAPIキーを設定
# 特にOPENAI_API_KEYなどのLLM APIキーを設定する

# Dockerコンテナを起動
docker-compose up -d

# ブラウザで以下のURLにアクセス
# http://localhost:3000
```

**2. クラウドサービスとして利用する（最も簡単）**:

Dify.AI が提供する[クラウドサービス](https://cloud.dify.ai)を利用すると、インストール不要ですぐに利用を開始できます。

- アカウント登録
- API キーの設定
- すぐに利用開始可能

**3. サーバーに手動インストール（上級者向け）**:

必要なもの:

- Node.js 18 以上
- Python 3.10 以上
- PostgreSQL 14 以上
- Redis 6.0 以上

手順は[公式インストールガイド](https://docs.dify.ai/getting-started/install-self-hosted/installation-guide)を参照してください。

## ハンズオン

### hello world 的アプリを何個か作って雰囲気を掴む

1. チャットが使える

   **基本的なチャットボットの作成**:

   1. Dify ダッシュボードから「新規作成」→「チャットアプリケーション」を選択
   2. アプリに名前とモデル（例：GPT-3.5-turbo）を設定
   3. プロンプトライブラリからテンプレートを選択するか、独自のプロンプトを記述
   4. プロンプト例: 「あなたは親切なアシスタントです。ユーザーの質問に丁寧に答えてください。」
   5. 「発行して共有」をクリックしてチャットボットを公開

   参考: [Dify 公式ガイド - チャットアプリ作成](https://docs.dify.ai/getting-started/create-an-application)

2. ワークフローが作れる

   **シンプルなワークフローの構築**:

   1. 「ワークフロー」タブを選択
   2. 新規ワークフローを作成し、名前を付ける
   3. スタートノードから始まるフローを作成
   4. 「LLM 実行」ノードを追加し、プロンプトを設定
   5. 条件分岐を追加（例：感情分析結果によって返答を変える）
   6. テストして挙動を確認

   具体例: ユーザーの質問を分析し、質問タイプによって異なる回答パスに分岐させるワークフロー

   参考: [Dify 公式ブログ - ワークフロー入門](https://blog.dify.ai/posts/workflow-introduction)

3. RAG ができる

   **独自データを使った RAG システム構築**:

   1. 「データセット」→「新規データセット」を作成
   2. データタイプとして「テキスト」や「PDF ドキュメント」などを選択
   3. ファイルをアップロードまたはテキストを入力
   4. インデックス作成が完了したら、アプリケーション設定で「知識ベース」を有効化
   5. 作成したデータセットを接続
   6. クエリ設定を調整（関連度スコア、検索結果数など）

   具体例: 会社の製品マニュアルをアップロードし、製品に関する質問に回答できるアシスタント

   参考: [RAG システム構築チュートリアル](https://docs.dify.ai/guides/retrieval-augmentation)

4. Web API をコールできる

   **API を利用したアプリケーション連携**:

   1. ワークフローで「API 呼び出し」ノードを追加
   2. 呼び出す API の URL、メソッド、ヘッダー、ボディを設定
   3. レスポンスを変数として保存
   4. レスポンスデータを LLM に渡して処理

   具体例: 天気 API を呼び出し、天気情報に基づいた服装アドバイスを生成するアプリ

   ```json
   // API設定例
   {
     "url": "https://api.openweathermap.org/data/2.5/weather",
     "method": "GET",
     "params": {
       "q": "{{user_location}}",
       "appid": "your_api_key"
     }
   }
   ```

   参考: [Dify API 統合ガイド](https://docs.dify.ai/guides/api-integration)

5. 自前のカスタムコードを利用できる

   **Python コードを実行する方法**:

   1. ワークフローで「コード実行」ノードを選択
   2. Python コードを入力
   3. 入力変数と出力変数を定義
   4. コード実行結果を LLM に渡すか条件分岐に利用

   サンプル Python コード:

   ```python
   import pandas as pd

   # 入力データを処理
   def process_data(input_data):
     # pandas でデータ分析
     df = pd.DataFrame(input_data)
     result = df.describe().to_dict()
     return {"summary": result}

   # 関数を実行
   output = process_data(input_data)
   ```

   参考: [カスタムコード実行ドキュメント](https://docs.dify.ai/guides/code-interpreter)

### 自分のビジネス課題を定義して実装する

1. 要件定義

   **ビジネス課題の明確化手順**:

   - 解決したい具体的な問題は何か？
   - 誰がユーザーになるか？
   - ユーザーがアプリを使って達成したいことは？
   - 成功の基準は何か？

   要件定義テンプレート:

   ```
   アプリケーション名:
   目的:
   ターゲットユーザー:
   主な機能:
   成功基準:
   ```

   例: 営業資料から素早く質問に答えられるアシスタントの作成

2. 入出力の定義

   **入出力設計のポイント**:

   - ユーザー入力: どのような質問や指示を受け付けるか？
   - システム出力: どのようなフォーマットで回答するか？
   - エラーケース: 入力が不適切な場合の対応は？

   入出力定義例:

   ```
   入力: ユーザーからの製品に関する質問テキスト
   内部処理: 質問を分類し、関連資料を検索、回答を生成
   出力: 製品情報の要約と詳細へのリンク
   ```

3. 利用するデータの定義

   **データ準備のステップ**:

   - 必要なデータは何か？（ドキュメント、FAQ、製品情報など）
   - データのフォーマットとクレンジング方法
   - データのチャンク化とインデックス作成方法
   - データの更新頻度と方法

   データ準備チェックリスト:

   - [ ] データの収集
   - [ ] 不要な情報の削除
   - [ ] 適切なサイズにチャンク化
   - [ ] メタデータの付与
   - [ ] インデックスの作成

4. ワークフローのデザイン

   **ワークフロー設計プロセス**:

   1. 主要なユーザーの行動パスを特定
   2. 各ステップで必要な処理を定義
   3. 分岐条件を特定
   4. 外部システム連携の要件を確認
   5. エラー処理を設計

   ワークフローのスケッチ例:

   ```
   開始 → 入力受付 → 質問意図分析 →
   条件分岐（製品質問/サポート質問/その他） →
   関連情報検索 → 回答生成 → フォローアップ提案 → 終了
   ```

# 参考資料

- [langgenius/dify](https://github.com/langgenius/dify)
- [世界一わかりみの深い Dify](https://tech-lab.sios.jp/archives/46102)
- [Dify 公式ドキュメント](https://docs.dify.ai/)
- [AI アプリ開発基礎ガイド](https://learn.microsoft.com/ja-jp/azure/ai-services/openai/concepts/use-your-data)
- [効果的なプロンプト設計](https://platform.openai.com/docs/guides/prompt-engineering)
- [RAG 設計パターン集](https://www.pinecone.io/learn/retrieval-augmented-generation-patterns/)
- [Dify Discord コミュニティ](https://discord.gg/FngNHpbcY7)
- [Dify 月間ウェビナーアーカイブ](https://www.youtube.com/@dify-ai)
